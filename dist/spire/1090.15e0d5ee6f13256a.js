"use strict";(self.webpackChunkspire=self.webpackChunkspire||[]).push([[1090],{1090:(R,f,a)=>{a.r(f),a.d(f,{PerfilModule:()=>O});var d=a(6814),p=a(2787),_=a(4368),i=a(6223),A=a(4716),U=a(3519),c=a.n(U),e=a(9212),q=a(2799),T=a(930),C=a(617),m=a(4170),y=a(2032),N=a(2296),w=a(8525),I=a(3680),g=a(4414);function P(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Nombre de usuario es requerido "),e.qZA())}function F(o,n){if(1&o&&(e.TgZ(0,"mat-option",35),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.display_name)}}function J(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Pro favor ingrese un email valido "),e.qZA())}function x(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Nombre es requerido "),e.qZA())}function Q(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Apellidos es requerido "),e.qZA())}function k(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El numero de cedula de identidad es requerido "),e.qZA())}function S(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El numero de celular es requerido "),e.qZA())}const E=[{path:"",component:(()=>{class o{constructor(t,l,r){this.fb=t,this.userService=l,this.tokenStorage=r,this.hide=!0,this.submitted=!1,this.loading=!1,this.colores=[{clase:"fc-event-primary",codigo:"#007bff",nombre:"primary"},{clase:"fc-event-warning",codigo:"#ff9800",nombre:"warning"},{clase:"fc-event-success",codigo:"#53b958",nombre:"success"},{clase:"fc-event-danger",codigo:"#f9483b",nombre:"danger"},{clase:"fc-event-info",codigo:"#03c5de",nombre:"info"},{clase:"fc-event-pink",codigo:"#ff00e1",nombre:"pink"},{clase:"fc-event-green",codigo:"#74eb0d",nombre:"green"},{clase:"fc-event-purple",codigo:"#8b53b9",nombre:"purple"},{clase:"fc-event-gray",codigo:"#878787",nombre:"gray"},{clase:"fc-event-yellow",codigo:"#e3c70e",nombre:"yellow"}],this.listaRoles(),this.createForm()}ngOnInit(){this.tokenStorage.getUser()&&this.cargarDatosCredencial(this.tokenStorage.getUser())}cargarDatosCredencial(t){this.dataUser=t,this.form.patchValue({username:t.username,current_password:"",password:"",password_confirm:"",email:t.email,nombres:t.nombres,apellidos:t.apellidos,ci:t.ci,celular:t.celular,especialidad:t.especialidad,rol_id:t.rol_id,color:t.color})}listaRoles(){this.userService.getAllRoles().subscribe(t=>{this.roles=t})}createForm(){this.form=this.fb.group({username:[{value:"",disabled:!0},i.kI.required],current_password:[""],password:[""],password_confirm:[""],email:[{value:"",disabled:!0},i.kI.email],nombres:[{value:"",disabled:!0},[i.kI.required,i.kI.pattern("[a-zA-Z\xf1\xd1\xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda ]*")]],apellidos:[{value:"",disabled:!0},[i.kI.required,i.kI.pattern("[a-zA-Z\xf1\xd1\xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda ]*")]],ci:[{value:"",disabled:!0},i.kI.required],celular:[{value:"",disabled:!0},[i.kI.required,i.kI.maxLength(8),i.kI.pattern("[0-9]*")]],especialidad:[{value:"",disabled:!0}],rol_id:[{value:"",disabled:!0},i.kI.required],color:[{value:"",disabled:!0}]})}getPasswordChangePayload(){return{current_password:this.form.get("current_password")?.value,password:this.form.get("password")?.value,password_confirm:this.form.get("password_confirm")?.value}}cambiarPassword(t){this.submitted=!0,this.loading=!0;const l=this.getPasswordChangePayload();l.password===l.password_confirm?this.userService.cambiarPassword(l).pipe((0,A.x)(()=>{this.form.markAsPristine(),this.loading=!1})).subscribe(r=>{c().fire({position:"center",icon:"success",title:"Contrase\xf1a cambiado con exito",text:r.succes,showConfirmButton:!1,timer:1500}),this.form.patchValue({current_password:"",password:"",password_confirm:""})},r=>{c().fire({icon:"error",title:"No se pudo cambiar la contrase\xf1a",text:r.error}),this.submitted=!1,this.loading=!1}):(c().fire({icon:"error",title:"La nueva contrase\xf1a no coincide con la confirmada"}),this.submitted=!1,this.loading=!1)}static#e=this.\u0275fac=function(l){return new(l||o)(e.Y36(i.qu),e.Y36(q.K),e.Y36(T.i))};static#r=this.\u0275cmp=e.Xpm({type:o,selectors:[["form-perfil"]],decls:110,vars:19,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","active_item"],[1,"row","clearfix"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"card"],[1,"body"],[1,"register-form","m-4",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-6","col-lg-6","col-md-12","col-sm-12","mb-2"],["appearance","outline",1,"example-full-width","uniform-height"],["matInput","","formControlName","username","required",""],["matSuffix",""],[4,"ngIf"],["formControlName","rol_id"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-2"],["appearance","outline",1,"example-full-width"],["matInput","","formControlName","email"],["matInput","","formControlName","nombres","required",""],["matInput","","formControlName","apellidos","required",""],["matInput","","formControlName","ci","required",""],["matInput","","formControlName","celular","required",""],["matInput","","formControlName","especialidad","required",""],[1,"header"],[1,"col-xl-4","col-lg-6","col-md-12","col-sm-12","mb-2"],["matInput","","formControlName","current_password",3,"type"],["matSuffix","",3,"click"],["matInput","","formControlName","password",3,"type"],["matInput","","formControlName","password_confirm",3,"type"],[1,"example-button-row"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["type","button","mat-raised-button","","color","warn","tabindex","-1"],[3,"value"]],template:function(l,r){if(1&l&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"form",8),e.NdJ("ngSubmit",function(){return r.cambiarPassword(r.form.value)}),e.TgZ(9,"div",9)(10,"div",10)(11,"mat-form-field",11)(12,"mat-label"),e._uU(13,"Nombre de Usuario"),e.qZA(),e._UZ(14,"input",12),e.TgZ(15,"mat-icon",13),e._uU(16,"person"),e.qZA(),e.YNc(17,P,2,0,"mat-error",14),e.qZA()(),e.TgZ(18,"div",10)(19,"mat-form-field",11)(20,"mat-label"),e._uU(21,"Roles"),e.qZA(),e.TgZ(22,"mat-select",15)(23,"mat-option",16),e._uU(24,"Ninguno"),e.qZA(),e.YNc(25,F,2,2,"mat-option",17),e.qZA()()()(),e.TgZ(26,"div",9)(27,"div",18)(28,"mat-form-field",19)(29,"mat-label"),e._uU(30,"Correo Electronico"),e.qZA(),e._UZ(31,"input",20),e.TgZ(32,"mat-icon",13),e._uU(33,"email"),e.qZA(),e.YNc(34,J,2,0,"mat-error",14),e.qZA()()(),e.TgZ(35,"div",9)(36,"div",10)(37,"mat-form-field",19)(38,"mat-label"),e._uU(39,"Nombre"),e.qZA(),e._UZ(40,"input",21),e.TgZ(41,"mat-icon",13),e._uU(42,"face"),e.qZA(),e.YNc(43,x,2,0,"mat-error",14),e.qZA()(),e.TgZ(44,"div",10)(45,"mat-form-field",19)(46,"mat-label"),e._uU(47,"Apellidos"),e.qZA(),e._UZ(48,"input",22),e.TgZ(49,"mat-icon",13),e._uU(50,"face"),e.qZA(),e.YNc(51,Q,2,0,"mat-error",14),e.qZA()()(),e.TgZ(52,"div",9)(53,"div",10)(54,"mat-form-field",19)(55,"mat-label"),e._uU(56,"Cedula de Identidad"),e.qZA(),e._UZ(57,"input",23),e.TgZ(58,"mat-icon",13),e._uU(59,"badge"),e.qZA(),e.YNc(60,k,2,0,"mat-error",14),e.qZA()(),e.TgZ(61,"div",10)(62,"mat-form-field",19)(63,"mat-label"),e._uU(64,"Celular"),e.qZA(),e._UZ(65,"input",24),e.TgZ(66,"mat-icon",13),e._uU(67,"phone"),e.qZA(),e.YNc(68,S,2,0,"mat-error",14),e.qZA()()(),e.TgZ(69,"div",18)(70,"mat-form-field",19)(71,"mat-label"),e._uU(72,"Especialidad"),e.qZA(),e._UZ(73,"input",25),e.TgZ(74,"mat-icon",13),e._uU(75,"doctor"),e.qZA()()(),e.TgZ(76,"div",26)(77,"h2")(78,"strong"),e._uU(79,"Cambiar "),e.qZA(),e._uU(80," Contrase\xf1a "),e.qZA()(),e.TgZ(81,"div",9)(82,"div",27)(83,"mat-form-field",11)(84,"mat-label"),e._uU(85,"Contrase\xf1a Actual"),e.qZA(),e._UZ(86,"input",28),e.TgZ(87,"mat-icon",29),e.NdJ("click",function(){return r.hide=!r.hide}),e._uU(88),e.qZA()()(),e.TgZ(89,"div",27)(90,"mat-form-field",11)(91,"mat-label"),e._uU(92,"Nueva Contrase\xf1a"),e.qZA(),e._UZ(93,"input",30),e.TgZ(94,"mat-icon",29),e.NdJ("click",function(){return r.hide=!r.hide}),e._uU(95),e.qZA()()(),e.TgZ(96,"div",27)(97,"mat-form-field",11)(98,"mat-label"),e._uU(99,"Repetir Nueva Contrase\xf1a"),e.qZA(),e._UZ(100,"input",31),e.TgZ(101,"mat-icon",29),e.NdJ("click",function(){return r.hide=!r.hide}),e._uU(102),e.qZA()()()(),e.TgZ(103,"div",9)(104,"div",18)(105,"div",32)(106,"button",33),e._uU(107,"Guardar"),e.qZA(),e.TgZ(108,"button",34),e._uU(109,"Cancelar"),e.qZA()()()()()()()()()()()),2&l){let s,u,v,h,Z,b;e.xp6(3),e.Q6J("title","Mi Perfil")("active_item","Perfil"),e.xp6(5),e.Q6J("formGroup",r.form),e.xp6(9),e.Q6J("ngIf",null==(s=r.form.get("username"))?null:s.hasError("required")),e.xp6(8),e.Q6J("ngForOf",r.roles),e.xp6(9),e.Q6J("ngIf",(null==(u=r.form.get("email"))?null:u.hasError("required"))||(null==(u=r.form.get("email"))?null:u.touched)),e.xp6(9),e.Q6J("ngIf",null==(v=r.form.get("nombres"))?null:v.hasError("required")),e.xp6(8),e.Q6J("ngIf",null==(h=r.form.get("apellidos"))?null:h.hasError("required")),e.xp6(9),e.Q6J("ngIf",null==(Z=r.form.get("ci"))?null:Z.hasError("required")),e.xp6(8),e.Q6J("ngIf",null==(b=r.form.get("celular"))?null:b.hasError("required")),e.xp6(18),e.Q6J("type",r.hide?"password":"text"),e.xp6(2),e.hij(" ",r.hide?"visibility_off":"visibility"," "),e.xp6(5),e.Q6J("type",r.hide?"password":"text"),e.xp6(2),e.hij(" ",r.hide?"visibility_off":"visibility"," "),e.xp6(5),e.Q6J("type",r.hide?"password":"text"),e.xp6(2),e.hij(" ",r.hide?"visibility_off":"visibility"," "),e.xp6(4),e.ekj("auth-spinner",r.loading),e.Q6J("disabled",!r.form.valid||r.loading)}},dependencies:[d.sg,d.O5,C.Hw,m.KE,m.hX,m.TO,m.R9,y.Nt,N.lW,w.gD,I.ey,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,g.L],styles:[".uniform-height[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:center}"]})}return o})(),canActivate:[_.a]}];let Y=(()=>{class o{static#e=this.\u0275fac=function(l){return new(l||o)};static#r=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(E),p.Bz]})}return o})();var j=a(6220);let O=(()=>{class o{static#e=this.\u0275fac=function(l){return new(l||o)};static#r=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[d.ez,Y,j.g,i.u5,i.UX,g.L]})}return o})()}}]);